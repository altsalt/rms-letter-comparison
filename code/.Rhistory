df_facts$sr_with_email <- length(df_sr$Username[df_sr$Email != ''])
df_facts$total_with_twitter <- length(df$Username[df$Twitter != ''])
df_facts$rr_with_twitter <- length(df_rr$Username[df_rr$Twitter != ''])
df_facts$sr_with_twitter <- length(df_sr$Username[df_sr$Twitter != ''])
df_facts$total_with_company <- length(df$Username[df$Company != ''])
df_facts$rr_with_company <- length(df_rr$Username[df_rr$Company != ''])
df_facts$sr_with_company <- length(df_sr$Username[df_sr$Company != ''])
df_facts$total_unique_companies <- length(unique(df$Company[df$Company != '']))
df_facts$rr_unique_companies <- length(unique(df_rr$Company[df_rr$Company != '']))
df_facts$sr_unique_companies <- length(unique(df_sr$Company[df_sr$Company != '']))
df_facts$total_mean_account_age <- mean(df$AccountAge)
df_facts$rr_mean_account_age <- mean(df_rr$AccountAge)
df_facts$sr_mean_account_age <- mean(df_sr$AccountAge)
df_facts$total_median_account_age <- median(df$AccountAge)
df_facts$rr_median_account_age <- median(df_rr$AccountAge)
df_facts$sr_median_account_age <- median(df_sr$AccountAge)
df_facts$total_mean_public_repos <- mean(df$PublicRepos)
df_facts$rr_mean_public_repos <- mean(df_rr$PublicRepos)
df_facts$sr_mean_public_repos <- mean(df_sr$PublicRepos)
df_facts$total_median_public_repos <- median(df$PublicRepos)
df_facts$rr_median_public_repos <- median(df_rr$PublicRepos)
df_facts$sr_median_public_repos <- median(df_sr$PublicRepos)
df_facts$total_mean_public_gists <- mean(df$PublicGists)
df_facts$rr_mean_public_gists <- mean(df_rr$PublicGists)
df_facts$sr_mean_public_gists <- mean(df_sr$PublicGists)
df_facts$total_median_public_gists <- median(df$PublicGists)
df_facts$rr_median_public_gists <- median(df_rr$PublicGists)
df_facts$sr_median_public_gists <- median(df_sr$PublicGists)
df_facts$total_mean_followers <- mean(df$Followers)
df_facts$rr_mean_followers <- mean(df_rr$Followers)
df_facts$sr_mean_followers <- mean(df_sr$Followers)
df_facts$total_median_followers <- median(df$Followers)
df_facts$rr_median_followers <- median(df_rr$Followers)
df_facts$sr_median_followers <- median(df_sr$Followers)
df_facts$total_mean_following <- mean(df$Following)
df_facts$rr_mean_following <- mean(df_rr$Following)
df_facts$sr_mean_following <- mean(df_sr$Following)
df_facts$total_median_following <- median(df$Following)
df_facts$rr_median_following <- median(df_rr$Following)
df_facts$sr_median_following <- median(df_sr$Following)
# Percentages
df_facts$total_percentage_with_name <- 100 * (length(df$Username[df$Name != '']) / df_facts$orig_total_signers)
df_facts$rr_percentage_with_name <- 100 * (length(df_rr$Username[df_rr$Name != '']) / df_facts$orig_rr_signers)
df_facts$sr_percentage_with_name <- 100 * (length(df_sr$Username[df_sr$Name != '']) / df_facts$orig_sr_signers)
df_facts$total_percentage_with_bio <- 100 * (length(df$Username[df$Bio != '']) / df_facts$orig_total_signers)
df_facts$rr_percentage_with_bio <- 100 * (length(df_rr$Username[df_rr$Bio != '']) / df_facts$orig_rr_signers)
df_facts$sr_percentage_with_bio <- 100 * (length(df_sr$Username[df_sr$Bio != '']) / df_facts$orig_sr_signers)
df_facts$total_percentage_with_blog <- 100 * (length(df$Username[df$Blog != '']) / df_facts$orig_total_signers)
df_facts$rr_percentage_with_blog <- 100 * (length(df_rr$Username[df_rr$Blog != '']) / df_facts$orig_rr_signers)
df_facts$sr_percentage_with_blog <- 100 * (length(df_sr$Username[df_sr$Blog != '']) / df_facts$orig_sr_signers)
df_facts$total_percentage_with_email <- 100 * (length(df$Username[df$Email != '']) / df_facts$orig_total_signers)
df_facts$rr_percentage_with_email <- 100 * (length(df_rr$Username[df_rr$Email != '']) / df_facts$orig_rr_signers)
df_facts$sr_percentage_with_email <- 100 * (length(df_sr$Username[df_sr$Email != '']) / df_facts$orig_sr_signers)
df_facts$total_percentage_with_twitter <- 100 * (length(df$Username[df$Twitter != '']) / df_facts$orig_total_signers)
df_facts$rr_percentage_with_twitter <- 100 * (length(df_rr$Username[df_rr$Twitter != '']) / df_facts$orig_rr_signers)
df_facts$sr_percentage_with_twitter <- 100 * (length(df_sr$Username[df_sr$Twitter != '']) / df_facts$orig_sr_signers)
df_facts$total_percentage_with_company <- 100 * (length(df$Username[df$Company != '']) / df_facts$orig_total_signers)
df_facts$rr_percentage_with_company <- 100 * (length(df_rr$Username[df_rr$Company != '']) / df_facts$orig_rr_signers)
df_facts$sr_percentage_with_company <- 100 * (length(df_sr$Username[df_sr$Company != '']) / df_facts$orig_sr_signers)
rr_column <- c(df_facts$orig_rr_signers, df_facts$rr_percentage_with_name,
df_facts$rr_percentage_with_bio, df_facts$rr_percentage_with_email,
df_facts$rr_percentage_with_blog, df_facts$rr_percentage_with_twitter,
df_facts$rr_percentage_with_company, df_facts$rr_unique_companies,
df_facts$rr_mean_account_age, df_facts$rr_median_account_age,
df_facts$rr_mean_public_repos, df_facts$rr_median_public_repos,
df_facts$rr_mean_public_gists, df_facts$rr_median_public_gists,
df_facts$rr_mean_followers, df_facts$rr_median_followers,
df_facts$rr_mean_following, df_facts$rr_median_following)
sr_column <- c(df_facts$orig_sr_signers, df_facts$sr_percentage_with_name,
df_facts$sr_percentage_with_bio, df_facts$sr_percentage_with_email,
df_facts$sr_percentage_with_blog, df_facts$sr_percentage_with_twitter,
df_facts$sr_percentage_with_company, df_facts$sr_unique_companies,
df_facts$sr_mean_account_age, df_facts$sr_median_account_age,
df_facts$sr_mean_public_repos, df_facts$sr_median_public_repos,
df_facts$sr_mean_public_gists, df_facts$sr_median_public_gists,
df_facts$sr_mean_followers, df_facts$sr_median_followers,
df_facts$sr_mean_following, df_facts$sr_median_following)
total_column <- c(df_facts$orig_total_signers, df_facts$total_percentage_with_name,
df_facts$total_percentage_with_bio, df_facts$total_percentage_with_email,
df_facts$total_percentage_with_blog, df_facts$total_percentage_with_twitter,
df_facts$total_percentage_with_company, df_facts$total_unique_companies,
df_facts$total_mean_account_age, df_facts$total_median_account_age,
df_facts$total_mean_public_repos, df_facts$total_median_public_repos,
df_facts$total_mean_public_gists, df_facts$total_median_public_gists,
df_facts$total_mean_followers, df_facts$total_median_followers,
df_facts$total_mean_following, df_facts$total_median_following)
facts_table <- data.frame(rr_column, sr_column, total_column)
names(facts_table) <- c('Reject rms', 'Support rms', 'Total')
rownames(facts_table) <- c('Number of Signers', 'Percentage with Name',
'Percentage with Bio', 'Percentage with Email',
'Percentage with Blog', 'Percentage with Twitter',
'Percentage with Company', 'Total Unique Companies',
'Mean Account Age (in weeks)', 'Median Account Age (in weeks)',
'Mean Public Repos', 'Median Public Repos',
'Mean Public Gists', 'Median Public Gists',
'Mean Followers', 'Median Followers',
'Mean Following', 'Median Following')
round(facts_table, digits=2)
facts_table$Total <- NULL
facts_table <- melt(rownames_to_column(facts_table, 'Metric'))
gg <- ggplot(facts_table, aes(x=Metric, y=value)) +
geom_bar(aes(fill=variable), stat='identity', position='identity')
gg
gg <- ggplot(facts_table, aes(x=Metric, y=value)) +
geom_bar(aes(fill=variable), stat='identity', position='identity') +
theme_bw()+
theme(axis.text.x = element_text(angle=-40, hjust=.1))
gg
facts_table
facts_table$Metric
### ---
# title: "RMS Letter Comparison"
# author: "Wm Salt Hale"
# date: "March 24, 2021"
# license: "GPL-3"
## ---
# Clean Workspace
rm(list = ls())
# Global Variables
gen_plots_toggle <- FALSE
# Load Libraries
required_pkgs <- c("here", "tidyverse")
installed_pkgs <- installed.packages()
sapply(required_pkgs, function(p) {
if(!p %in% installed_pkgs[,1]) {
install.packages(p)
}
})
# https://stackoverflow.com/questions/8175912/load-multiple-packages-at-once/8176099#8176099
lapply(required_pkgs, require, character.only = TRUE)
here::i_am('code/01-process_data.R')
here()
# Helper Functions
source(here('code', '99_helpers.R'))
# Load Data
df <- read.csv(here('data', 'rms-letter-signers.csv'))
#df <- readRDS(here('data', 'dataset.Rds'))
#df_facts <- readRDS(here('data', 'facts.Rds'))
# Drop Unused Columns
df$ID <- df$NodeID <- df$Gravatar <- df$Collaborators <- df$Inviter <-
df$PrivateGists <- df$PrivateRepos <- df$OwnedPrivateRepos <-
df$Plan <- df$Role <- df$TeamCount <- df$Type <- df$DiskUsage <-
df$URL <- df$FollowersURL <- df$FollowingURL <- df$ReposURL <-
df$StarredURL <-df$GistsURL <- df$htmlURL <- df$EventsURL <-
df$OrganizationsURL <- df$InvitationTeamsURL <- df$ReceivedEventsURL <- df$SubscriptionsURL <-
NULL
# initialize facts list, collect original state
df_facts <- list()
# store facts
df_facts$orig_total_signers <- length(df$Username)
df_facts$orig_rr_signers <- length(df$Username[df$Repo == 'rr'])
df_facts$orig_sr_signers <- length(df$Username[df$Repo == 'sr'])
df <- df %>%
mutate(AccountAge = as.numeric(difftime(Updated, Created), units='weeks'))
df_rr <- df[df$Repo == 'rr',]
df_sr <- df[df$Repo == 'sr',]
df_facts$total_with_name <- length(df$Username[df$Name != ''])
df_facts$rr_with_name <- length(df_rr$Username[df_rr$Name != ''])
df_facts$sr_with_name <- length(df_sr$Username[df_sr$Name != ''])
df_facts$total_with_bio <- length(df$Username[df$Bio != ''])
df_facts$rr_with_bio <- length(df_rr$Username[df_rr$Bio != ''])
df_facts$sr_with_bio <- length(df_sr$Username[df_sr$Bio != ''])
df_facts$total_with_blog <- length(df$Username[df$Blog != ''])
df_facts$rr_with_blog <- length(df_rr$Username[df_rr$Blog != ''])
df_facts$sr_with_blog <- length(df_sr$Username[df_sr$Blog != ''])
df_facts$total_with_email <- length(df$Username[df$Email != ''])
df_facts$rr_with_email <- length(df_rr$Username[df_rr$Email != ''])
df_facts$sr_with_email <- length(df_sr$Username[df_sr$Email != ''])
df_facts$total_with_twitter <- length(df$Username[df$Twitter != ''])
df_facts$rr_with_twitter <- length(df_rr$Username[df_rr$Twitter != ''])
df_facts$sr_with_twitter <- length(df_sr$Username[df_sr$Twitter != ''])
df_facts$total_with_company <- length(df$Username[df$Company != ''])
df_facts$rr_with_company <- length(df_rr$Username[df_rr$Company != ''])
df_facts$sr_with_company <- length(df_sr$Username[df_sr$Company != ''])
df_facts$total_unique_companies <- length(unique(df$Company[df$Company != '']))
df_facts$rr_unique_companies <- length(unique(df_rr$Company[df_rr$Company != '']))
df_facts$sr_unique_companies <- length(unique(df_sr$Company[df_sr$Company != '']))
df_facts$total_mean_account_age <- mean(df$AccountAge)
df_facts$rr_mean_account_age <- mean(df_rr$AccountAge)
df_facts$sr_mean_account_age <- mean(df_sr$AccountAge)
df_facts$total_median_account_age <- median(df$AccountAge)
df_facts$rr_median_account_age <- median(df_rr$AccountAge)
df_facts$sr_median_account_age <- median(df_sr$AccountAge)
df_facts$total_mean_public_repos <- mean(df$PublicRepos)
df_facts$rr_mean_public_repos <- mean(df_rr$PublicRepos)
df_facts$sr_mean_public_repos <- mean(df_sr$PublicRepos)
df_facts$total_median_public_repos <- median(df$PublicRepos)
df_facts$rr_median_public_repos <- median(df_rr$PublicRepos)
df_facts$sr_median_public_repos <- median(df_sr$PublicRepos)
df_facts$total_mean_public_gists <- mean(df$PublicGists)
df_facts$rr_mean_public_gists <- mean(df_rr$PublicGists)
df_facts$sr_mean_public_gists <- mean(df_sr$PublicGists)
df_facts$total_median_public_gists <- median(df$PublicGists)
df_facts$rr_median_public_gists <- median(df_rr$PublicGists)
df_facts$sr_median_public_gists <- median(df_sr$PublicGists)
df_facts$total_mean_followers <- mean(df$Followers)
df_facts$rr_mean_followers <- mean(df_rr$Followers)
df_facts$sr_mean_followers <- mean(df_sr$Followers)
df_facts$total_median_followers <- median(df$Followers)
df_facts$rr_median_followers <- median(df_rr$Followers)
df_facts$sr_median_followers <- median(df_sr$Followers)
df_facts$total_mean_following <- mean(df$Following)
df_facts$rr_mean_following <- mean(df_rr$Following)
df_facts$sr_mean_following <- mean(df_sr$Following)
df_facts$total_median_following <- median(df$Following)
df_facts$rr_median_following <- median(df_rr$Following)
df_facts$sr_median_following <- median(df_sr$Following)
# Percentages
df_facts$total_percentage_with_name <- 100 * (length(df$Username[df$Name != '']) / df_facts$orig_total_signers)
df_facts$rr_percentage_with_name <- 100 * (length(df_rr$Username[df_rr$Name != '']) / df_facts$orig_rr_signers)
df_facts$sr_percentage_with_name <- 100 * (length(df_sr$Username[df_sr$Name != '']) / df_facts$orig_sr_signers)
df_facts$total_percentage_with_bio <- 100 * (length(df$Username[df$Bio != '']) / df_facts$orig_total_signers)
df_facts$rr_percentage_with_bio <- 100 * (length(df_rr$Username[df_rr$Bio != '']) / df_facts$orig_rr_signers)
df_facts$sr_percentage_with_bio <- 100 * (length(df_sr$Username[df_sr$Bio != '']) / df_facts$orig_sr_signers)
df_facts$total_percentage_with_blog <- 100 * (length(df$Username[df$Blog != '']) / df_facts$orig_total_signers)
df_facts$rr_percentage_with_blog <- 100 * (length(df_rr$Username[df_rr$Blog != '']) / df_facts$orig_rr_signers)
df_facts$sr_percentage_with_blog <- 100 * (length(df_sr$Username[df_sr$Blog != '']) / df_facts$orig_sr_signers)
df_facts$total_percentage_with_email <- 100 * (length(df$Username[df$Email != '']) / df_facts$orig_total_signers)
df_facts$rr_percentage_with_email <- 100 * (length(df_rr$Username[df_rr$Email != '']) / df_facts$orig_rr_signers)
df_facts$sr_percentage_with_email <- 100 * (length(df_sr$Username[df_sr$Email != '']) / df_facts$orig_sr_signers)
df_facts$total_percentage_with_twitter <- 100 * (length(df$Username[df$Twitter != '']) / df_facts$orig_total_signers)
df_facts$rr_percentage_with_twitter <- 100 * (length(df_rr$Username[df_rr$Twitter != '']) / df_facts$orig_rr_signers)
df_facts$sr_percentage_with_twitter <- 100 * (length(df_sr$Username[df_sr$Twitter != '']) / df_facts$orig_sr_signers)
df_facts$total_percentage_with_company <- 100 * (length(df$Username[df$Company != '']) / df_facts$orig_total_signers)
df_facts$rr_percentage_with_company <- 100 * (length(df_rr$Username[df_rr$Company != '']) / df_facts$orig_rr_signers)
df_facts$sr_percentage_with_company <- 100 * (length(df_sr$Username[df_sr$Company != '']) / df_facts$orig_sr_signers)
rr_column <- c(df_facts$orig_rr_signers, df_facts$rr_percentage_with_name,
df_facts$rr_percentage_with_bio, df_facts$rr_percentage_with_email,
df_facts$rr_percentage_with_blog, df_facts$rr_percentage_with_twitter,
df_facts$rr_percentage_with_company, df_facts$rr_unique_companies,
df_facts$rr_mean_account_age, df_facts$rr_median_account_age,
df_facts$rr_mean_public_repos, df_facts$rr_median_public_repos,
df_facts$rr_mean_public_gists, df_facts$rr_median_public_gists,
df_facts$rr_mean_followers, df_facts$rr_median_followers,
df_facts$rr_mean_following, df_facts$rr_median_following)
sr_column <- c(df_facts$orig_sr_signers, df_facts$sr_percentage_with_name,
df_facts$sr_percentage_with_bio, df_facts$sr_percentage_with_email,
df_facts$sr_percentage_with_blog, df_facts$sr_percentage_with_twitter,
df_facts$sr_percentage_with_company, df_facts$sr_unique_companies,
df_facts$sr_mean_account_age, df_facts$sr_median_account_age,
df_facts$sr_mean_public_repos, df_facts$sr_median_public_repos,
df_facts$sr_mean_public_gists, df_facts$sr_median_public_gists,
df_facts$sr_mean_followers, df_facts$sr_median_followers,
df_facts$sr_mean_following, df_facts$sr_median_following)
total_column <- c(df_facts$orig_total_signers, df_facts$total_percentage_with_name,
df_facts$total_percentage_with_bio, df_facts$total_percentage_with_email,
df_facts$total_percentage_with_blog, df_facts$total_percentage_with_twitter,
df_facts$total_percentage_with_company, df_facts$total_unique_companies,
df_facts$total_mean_account_age, df_facts$total_median_account_age,
df_facts$total_mean_public_repos, df_facts$total_median_public_repos,
df_facts$total_mean_public_gists, df_facts$total_median_public_gists,
df_facts$total_mean_followers, df_facts$total_median_followers,
df_facts$total_mean_following, df_facts$total_median_following)
facts_table <- data.frame(rr_column, sr_column, total_column)
names(facts_table) <- c('Reject rms', 'Support rms', 'Total')
rownames(facts_table) <- c('Number of Signers', 'Percentage with Name',
'Percentage with Bio', 'Percentage with Email',
'Percentage with Blog', 'Percentage with Twitter',
'Percentage with Company', 'Total Unique Companies',
'Mean Account Age (in weeks)', 'Median Account Age (in weeks)',
'Mean Public Repos', 'Median Public Repos',
'Mean Public Gists', 'Median Public Gists',
'Mean Followers', 'Median Followers',
'Mean Following', 'Median Following')
round(facts_table, digits=2)
facts_table[1]
facts_table[,1]
facts_table[1,]
facts_table[1,] <- NULL
facts_table[-c(1, 8, 9)]
facts_table[-c(1, 8, 9), ]
facts_table[-c(1, 9, 10), ]
facts_table_orig <- facts_table
facts_table <- facts_table[-c(1, 9, 10), ]
facts_table$Total <- NULL
facts_table
facts_table <- melt(rownames_to_column(facts_table, 'Metric'))
facts_table
gg <- ggplot(facts_table, aes(x=Metric, y=value)) +
geom_bar(aes(fill=variable), stat='identity', position='identity') +
theme_bw()+
theme(axis.text.x = element_text(angle=-40, hjust=.1))
gg
gg <- ggplot(facts_table, aes(x=Metric, y=value)) +
geom_bar(aes(fill=variable), stat='identity', position='fill') +
theme_bw()+
theme(axis.text.x = element_text(angle=-40, hjust=.1))
gg
facts_table <- facts_table_orig
#facts_table$Total <- NULL
facts_table <- melt(rownames_to_column(facts_table, 'Metric'))
gg <- ggplot(facts_table, aes(x=Metric, y=value)) +
geom_bar(aes(fill=variable), stat='identity', position='fill') +
theme_bw()+
theme(axis.text.x = element_text(angle=-40, hjust=.1))
gg
#facts_table <- facts_table[-c(1, 9, 10), ]
facts_table$Total <- NULL
facts_table <- melt(rownames_to_column(facts_table, 'Metric'))
gg <- ggplot(facts_table, aes(x=Metric, y=value)) +
geom_bar(aes(fill=variable), stat='identity', position='fill') +
theme_bw()+
theme(axis.text.x = element_text(angle=-40, hjust=.1))
gg
facts_table <- facts_table_orig
#facts_table <- facts_table[-c(1, 9, 10), ]
facts_table$Total <- NULL
facts_table <- melt(rownames_to_column(facts_table, 'Metric'))
gg <- ggplot(facts_table, aes(x=Metric, y=value)) +
geom_bar(aes(fill=variable), stat='identity', position='fill') +
theme_bw()+
theme(axis.text.x = element_text(angle=-40, hjust=.1))
gg
gg <- ggplot(facts_table, aes(x=Metric, y=value)) +
geom_bar(aes(fill=variable), stat='identity', position='fill') +
theme_bw()+
theme(axis.text.x = element_text(angle=-40, hjust=.1)) +
coord_flip()
gg
gg <- ggplot(facts_table, aes(x=Metric, y=value)) +
geom_bar(aes(fill=variable), stat='identity', position='fill') +
theme_bw() +
theme(axis.text.x = element_text(angle=-40, hjust=.1)) +
coord_flip() +
geom_vline(x=0.5)
gg <- ggplot(facts_table, aes(x=Metric, y=value)) +
geom_bar(aes(fill=variable), stat='identity', position='fill') +
theme_bw() +
theme(axis.text.x = element_text(angle=-40, hjust=.1)) +
coord_flip() +
geom_vline(0.5)
geom_vline(xintercept=0.5)
gg <- ggplot(facts_table, aes(x=Metric, y=value)) +
geom_bar(aes(fill=variable), stat='identity', position='fill') +
theme_bw() +
theme(axis.text.x = element_text(angle=-40, hjust=.1)) +
coord_flip() +
geom_vline(xintercept=0.5)
gg
gg <- ggplot(facts_table, aes(x=Metric, y=value)) +
geom_bar(aes(fill=variable), stat='identity', position='fill') +
theme_bw() +
theme(axis.text.x = element_text(angle=-40, hjust=.1)) +
coord_flip() +
geom_hline(xintercept=0.5)
gg <- ggplot(facts_table, aes(x=Metric, y=value)) +
geom_bar(aes(fill=variable), stat='identity', position='fill') +
theme_bw() +
theme(axis.text.x = element_text(angle=-40, hjust=.1)) +
coord_flip() +
geom_hline(yintercept=0.5)
gg <- ggplot(facts_table, aes(x=Metric, y=value)) +
geom_bar(aes(fill=variable), stat='identity', position='fill') +
theme_bw() +
theme(axis.text.x = element_text(angle=-40, hjust=.1)) +
geom_hline(yintercept=0.5) +
coord_flip()
gg
gg <- ggplot(facts_table, aes(x=Metric, y=value)) +
geom_bar(aes(fill=variable), stat='identity', position='fill') +
geom_hline(yintercept=0.5) +
theme_bw() +
theme(axis.text.x = element_text(angle=-40, hjust=.1)) +
labs(fill='Letter to:',
x=element_blank(),
y=element_blank()) +
coord_flip()
gg
facts_table <- facts_table_orig
facts_table
facts_table %>%
mutate(tag = 1:n()) %>%
gather(metric, -tag) %>%
arrange(tag)
facts_table %>%
mutate(tag = 1:n())
facts_table %>%
mutate(tag = 1:n()) %>%
gather(rownames_to_column(facts_table, 'metric'), -tag) %>%
arrange(tag)
facts_table %>%
mutate(tag = 1:n()) %>%
gather(rownames_to_column(facts_table, 'metric'), -tag)
rownames_to_column(facts_table, 'metric')
facts_table <- rownames_to_column(facts_table, 'metric')
facts_table %>%
mutate(tag = 1:n()) %>%
gather(metric, -tag) %>%
arrange(tag)
facts_table %>%
mutate(tag = 1:n()) %>%
gather(metric, -tag)
facts_table %>%
mutate(tag = 1:n()) %>%
gather('metric', -tag) %>%
arrange(tag)
facts_table %>%
mutate(tag = 1:n()) %>%
gather('metric', 'observation', -tag) %>%
arrange(tag)
facts_table
facts_table %>%
mutate(tag = 1:n()) %>%
gather('metric', 'letter', 'observation', -tag) %>%
arrange(tag)
facts_table %>%
mutate(tag = 1:n()) %>%
gather('metric', c('letter', 'observation'), -tag) %>%
arrange(tag)
facts_table %>%
mutate(tag = 1:n()) %>%
pivot_longer(!'metric', names_to='letter', values_to='observation', -tag) %>%
arrange(tag)
facts_table %>%
mutate(tag = 1:n()) %>%
pivot_longer(!'metric', names_to='letter', values_to='observation') %>%
arrange(tag)
facts_table %>%
mutate(tag = 1:n()) %>%
pivot_longer(!'metric', names_to='letter', values_to='observation')
facts_table %>%
#  mutate(tag = 1:n()) %>%
pivot_longer(!'metric', names_to='letter', values_to='observation')
facts_table$Total <- NULL
facts_table <- rownames_to_column(facts_table, 'metric')
facts_table <- facts_table %>%
pivot_longer(!'metric', names_to='letter', values_to='observation')
facts_table <- facts_table_orig
facts_table$Total <- NULL
facts_table <- rownames_to_column(facts_table, 'metric')
facts_table <- facts_table %>%
pivot_longer(!'metric', names_to='letter', values_to='observation')
facts_table
gg <- ggplot(facts_table, aes(x=Metric, y=value)) +
geom_bar(aes(fill=variable), stat='identity', position='fill') +
geom_hline(yintercept=0.5) +
theme_bw() +
theme(axis.text.x = element_text(angle=-40, hjust=.1)) +
labs(fill='Letter to:',
x=element_blank(),
y=element_blank()) +
coord_flip()
gg
facts_table
gg <- ggplot(facts_table, aes(x=metric, y=observation)) +
geom_bar(aes(fill=letter), stat='identity', position='fill') +
geom_hline(yintercept=0.5) +
theme_bw() +
theme(axis.text.x = element_text(angle=-40, hjust=.1)) +
labs(fill='Letter to:',
x=element_blank(),
y=element_blank()) +
coord_flip()
gg
facts_table
facts_table$letter <- factor(facts_table$letter, levels=facts_table$letter)
facts_table
facts_table$metric <- factor(facts_table$metric, levels=facts_table$metric)
facts_table <- facts_table_orig
facts_table$Total <- NULL
facts_table$metric <- factor(facts_table$metric, levels=facts_table$metric)
facts_table <- rownames_to_column(facts_table, 'metric')
facts_table$metric <- factor(facts_table$metric, levels=facts_table$metric)
facts_table
facts_table <- facts_table %>%
pivot_longer(!'metric', names_to='letter', values_to='observation')
facts_table
gg <- ggplot(facts_table, aes(x=metric, y=observation)) +
geom_bar(aes(fill=letter), stat='identity', position='fill') +
geom_hline(yintercept=0.5) +
theme_bw() +
theme(axis.text.x = element_text(angle=-40, hjust=.1)) +
labs(fill='Letter to:',
x=element_blank(),
y=element_blank()) +
coord_flip()
gg
gg + scale_x_discrete(limits = rev(levels(facts_table$metric)))
gg <- ggplot(facts_table, aes(x=metric, y=observation)) +
geom_bar(aes(fill=letter), stat='identity', position='fill') +
geom_hline(yintercept=0.5) +
theme_bw() +
theme(axis.text.x = element_text(angle=-40, hjust=.1)) +
labs(fill='Letter to:',
x=element_blank(),
y=element_blank()) +
coord_flip() +
scale_x_discrete(limits = rev(levels(metric)))
gg <- ggplot(facts_table, aes(x=metric, y=observation)) +
geom_bar(aes(fill=letter), stat='identity', position='fill') +
geom_hline(yintercept=0.5) +
theme_bw() +
theme(axis.text.x = element_text(angle=-40, hjust=.1)) +
labs(fill='Letter to:',
x=element_blank(),
y=element_blank()) +
coord_flip() +
scale_x_discrete(limits = rev(levels(facts_table$metric))) +
scale_y_continuous(labels = percent)
library(scales)
gg <- ggplot(facts_table, aes(x=metric, y=observation)) +
geom_bar(aes(fill=letter), stat='identity', position='fill') +
geom_hline(yintercept=0.5) +
theme_bw() +
theme(axis.text.x = element_text(angle=-40, hjust=.1)) +
labs(fill='Letter to:',
x=element_blank(),
y=element_blank()) +
coord_flip() +
scale_x_discrete(limits = rev(levels(facts_table$metric))) +
scale_y_continuous(labels = percent)
gg
